---
import BaseLayout from '../../layouts/BaseLayout.astro'
import Header from '../../components/Header.astro';
import TopSection from '../../components/detail/TopSection.astro';
import ImageList from '../../components/detail/ImageList.astro';
import DescriptionSection from '../../components/detail/DescriptionSection.astro';
import { BGArray } from '../../library/randomcolor';
import { getWebContents, getWebContentDetail } from "../../library/microcms";

export async function getStaticPaths() {
  const response = await getWebContents({ fields: ["id"], limit: 100 });
  return response.contents.map((content: any) => ({
    params: {
      webcontentId: content.id,
    },
  }));
}

const { webcontentId } = Astro.params;
const webcontent = await getWebContentDetail(webcontentId as string);
const siteFetures = webcontent.features
const siteTitle = webcontent.title
const siteUrl = webcontent.url
const shortDescription = webcontent.shortdescription
const siteDescription = webcontent.description
const images = webcontent.images
---
<BaseLayout pageTitle={siteFetures}>
  <Header />
  <TopSection
    siteFeatures={siteFetures}
    siteTitle={siteTitle}
    shortDescription={shortDescription}
    siteUrl={siteUrl}
    backGroundColor={BGArray[Math.floor(Math.random() * (BGArray.length))]}
  />
  <ImageList images={images} />
  <DescriptionSection siteDescription={siteDescription} />
</BaseLayout>

<style>
  main {
    margin: auto;
    padding: 1em;
    max-width: 60ch;
  }
</style>